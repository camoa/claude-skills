# JSON Report Schemas

Structure of JSON reports generated by the skill.

## audit-report.json (Full Audit)

```json
{
  "meta": {
    "timestamp": "2025-12-06T14:32:00Z",
    "target_path": "web/modules/custom",
    "drupal_root": "/var/www/html/web"
  },
  "summary": {
    "overall_status": "warning",
    "coverage_status": "warning",
    "solid_status": "warning",
    "dry_status": "pass"
  },
  "coverage": {
    "line_coverage": 72.3,
    "tests_total": 45,
    "tests_passed": 43,
    "tests_failed": 2,
    "uncovered_files": ["Service/Foo.php", "Plugin/Bar.php"]
  },
  "solid": {
    "phpstan_errors": 3,
    "phpmd_violations": 5,
    "static_drupal_calls": 2,
    "violations": [
      {
        "principle": "DIP",
        "severity": "warning",
        "file": "src/Service/MyService.php",
        "line": 45,
        "message": "Static \\Drupal::service() call",
        "fix": "Inject via constructor"
      }
    ]
  },
  "dry": {
    "duplication_percentage": 4.2,
    "duplicated_lines": 120,
    "total_lines": 2857,
    "clones": [
      {
        "lines": 15,
        "files": [
          {"path": "src/Service/A.php", "start": 45, "end": 60},
          {"path": "src/Service/B.php", "start": 89, "end": 104}
        ]
      }
    ]
  },
  "recommendations": [
    {
      "priority": "high",
      "category": "coverage",
      "message": "Increase coverage to 80% target",
      "action": "Add tests for uncovered Service classes"
    }
  ]
}
```

## coverage-report.json

```json
{
  "timestamp": "2025-12-06T14:32:00Z",
  "line_coverage": 72.3,
  "tests_total": 45,
  "tests_passed": 43,
  "tests_failed": 2,
  "uncovered_files": ["Service/Foo.php", "Plugin/Bar.php"],
  "status": "warning"
}
```

## solid-report.json

```json
{
  "timestamp": "2025-12-06T14:32:00Z",
  "target_path": "web/modules/custom",
  "phpstan_errors": 3,
  "phpmd_violations": 5,
  "static_drupal_calls": 2,
  "violations": [
    {
      "principle": "SRP|DIP|LSP",
      "severity": "critical|warning|suggestion",
      "file": "path/to/file.php",
      "line": 45,
      "message": "Description of issue",
      "fix": "How to fix it"
    }
  ],
  "status": "warning"
}
```

## dry-report.json

```json
{
  "timestamp": "2025-12-06T14:32:00Z",
  "target_path": "web/modules/custom",
  "duplication_percentage": 4.2,
  "duplicated_lines": 120,
  "total_lines": 2857,
  "clones": [
    {
      "lines": 15,
      "tokens": 120,
      "files": [
        {"path": "src/Service/A.php", "start": 45, "end": 60},
        {"path": "src/Service/B.php", "start": 89, "end": 104}
      ]
    }
  ],
  "status": "pass"
}
```

## Status Values

- `pass` - All thresholds met
- `warning` - Soft thresholds exceeded
- `fail` - Hard thresholds exceeded

## Thresholds Reference

| Metric | Pass | Warning | Fail |
|--------|------|---------|------|
| Coverage | >80% | 70-80% | <70% |
| Duplication | <5% | 5-10% | >10% |
| PHPStan | 0 | 1-10 | >10 |
| PHPMD | <=10 | 11-20 | >20 |
